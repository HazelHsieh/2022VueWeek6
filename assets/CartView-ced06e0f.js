import{_ as f,o as n,c as r,a as _,d as t,F as m,f as b,g as i,t as u,h as x,v as C}from"./index-895acf2b.js";const{VITE_APP_URL:d,VITE_PATH:c}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"hazel_vue",BASE_URL:"/2022VueWeek6/",MODE:"production",DEV:!1,PROD:!0},I={data(){return{loadingStatus:{loadingItem:""},products:[],product:{},form:{user:{name:"",email:"",tel:"",address:""},message:""},cart:{}}},methods:{getProduct(s){const e=`${d}/api/${c}/product/${s}`;this.loadingStatus.loadingItem=s,this.$http.get(e).then(a=>{this.loadingStatus.loadingItem="",this.product=a.data.product,this.$refs.userProductModal.openModal()}).catch(a=>{alert(a.response.data.message)})},updateCart(s){this.loadingStatus.loadingItem=s.id;const e=`${d}/api/${c}/cart/${s.id}`,a={product_id:s.product_id,qty:s.qty};this.$http.put(e,{data:a}).then(h=>{alert(h.data.message),this.loadingStatus.loadingItem="",this.getCart()}).catch(h=>{alert(h.response.data.message),this.loadingStatus.loadingItem=""})},deleteAllCarts(){const s=`${d}/api/${c}/carts`;this.$http.delete(s).then(e=>{alert(e.data.message),this.getCart()}).catch(e=>{alert(e.response.data.message)})},getCart(){const s=`${d}/api/${c}/cart`;this.$http.get(s).then(e=>{this.cart=e.data.data}).catch(e=>{alert(e.response.data.message)})},removeCartItem(s){const e=`${d}/api/${c}/cart/${s}`;this.loadingStatus.loadingItem=s,this.$http.delete(e).then(a=>{alert(a.data.message),this.loadingStatus.loadingItem="",this.getCart()}).catch(a=>{alert(a.response.data.message)})},createOrder(){const s=`${d}/api/${c}/order`,e=this.form;this.$http.post(s,{data:e}).then(a=>{alert(a.data.message),this.$refs.form.resetForm(),this.getCart()}).catch(a=>{alert(a.response.data.message)})}},mounted(){this.getCart()}},y={class:"text-end"},v={class:"table align-middle"},$=t("thead",null,[t("tr",null,[t("th"),t("th",null,"品名"),t("th",{style:{width:"150px"}},"數量/單位"),t("th",null,"單價")])],-1),S=["onClick","disabled"],k={key:0,class:"fas fa-spinner fa-pulse"},V={key:0,class:"text-success"},P={class:"input-group input-group-sm"},A={class:"input-group mb-3"},E=["onUpdate:modelValue","onBlur","disabled"],T={class:"input-group-text",id:"basic-addon2"},B={class:"text-end"},D={key:0,class:"text-success"},U=t("td",{colspan:"3",class:"text-end"},"總計",-1),q={class:"text-end"},L={key:0},M=t("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),R={class:"text-end text-success"};function w(s,e,a,h,l,p){return n(),r(m,null,[_(" 這是購物車 "),t("div",y,[t("button",{class:"btn btn-outline-danger",type:"button",onClick:e[0]||(e[0]=(...o)=>p.deleteAllCarts&&p.deleteAllCarts(...o))},"清空購物車")]),t("table",v,[$,t("tbody",null,[l.cart.carts?(n(!0),r(m,{key:0},b(l.cart.carts,o=>(n(),r("tr",{key:o.id},[t("td",null,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:g=>p.removeCartItem(o.id),disabled:l.loadingStatus.loadingItem===o.id},[l.loadingStatus.loadingItem===o.id?(n(),r("i",k)):i("",!0),_(" x ")],8,S)]),t("td",null,[_(u(o.product.title)+" ",1),o.coupon?(n(),r("div",V," 已套用優惠券 ")):i("",!0)]),t("td",null,[t("div",P,[t("div",A,[x(t("input",{"onUpdate:modelValue":g=>o.qty=g,onBlur:g=>p.updateCart(o),disabled:l.loadingStatus.loadingItem===o.id,min:"1",type:"number",class:"form-control"},null,40,E),[[C,o.qty,void 0,{number:!0}]]),t("span",T,u(o.product.unit),1)])])]),t("td",B,[l.cart.final_total!==l.cart.total?(n(),r("small",D,"折扣價：")):i("",!0),_(" "+u(o.final_total),1)])]))),128)):i("",!0)]),t("tfoot",null,[t("tr",null,[U,t("td",q,u(l.cart.total),1)]),l.cart.final_total!==l.cart.total?(n(),r("tr",L,[M,t("td",R,u(l.cart.final_total),1)])):i("",!0)])])],64)}const N=f(I,[["render",w]]);export{N as default};
